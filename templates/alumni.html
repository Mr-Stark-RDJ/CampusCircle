{% extends "base.html" %}
{% block content %}
<div class="row justify-content-center g-4">
  <div class="col-12 col-xl-10">

    <div class="card shadow-sm mb-3">
      <div class="card-body">
        <div class="d-flex flex-column flex-xl-row align-items-xl-end justify-content-between gap-3">
          <h5 class="card-title mb-0">Alumni Directory</h5>
          <form class="d-flex flex-wrap gap-2 w-100" style="max-width:920px" method="get">
            <input class="form-control flex-grow-1" type="text" name="q" value="{{ q }}" placeholder="Search name or company">
            <input class="form-control" style="max-width:160px" type="text" name="year" value="{{ year }}" placeholder="Year">
            <input class="form-control" style="max-width:180px" type="text" name="branch" value="{{ branch }}" placeholder="Branch">
            <select class="form-select" name="n" style="max-width:140px">
              <option value="10" {% if per_page==10 %}selected{% endif %}>Show 10</option>
              <option value="25" {% if per_page==25 %}selected{% endif %}>Show 25</option>
              <option value="50" {% if per_page==50 %}selected{% endif %}>Show 50</option>
            </select>
            <button class="btn btn-primary">Filter</button>
          </form>
        </div>
      </div>
    </div>

    <div class="alert alert-info d-flex justify-content-between align-items-center">
      <div>Are you an alumnus? Join now.</div>
      <a class="btn btn-sm btn-outline-primary" href="{{ url_for('register') }}">Register</a>
    </div>

    <div class="card shadow-sm">
      <div class="card-body">
        {% if rows %}
        <div class="list-group list-group-flush">
          {% for a in rows %}
          <div class="list-group-item d-flex flex-column flex-md-row justify-content-between align-items-md-center">
            <div class="mb-2 mb-md-0">
              <div class="fw-semibold">{{ a.full_name or '—' }}</div>
              <div class="text-secondary small">{{ a.company or '—' }} · {{ a.graduation_year or '—' }} · {{ a.branch or '—' }}</div>
            </div>
            <div>
              {% if a.linkedin %}
              <a class="btn btn-sm btn-outline-info" target="_blank" rel="noopener" href="{{ a.linkedin }}">LinkedIn</a>
              {% else %}<span class="text-muted small">No Link</span>{% endif %}
            </div>
          </div>
          {% endfor %}
        </div>

        <nav class="mt-3">
          <ul class="pagination justify-content-center">
            <li class="page-item {% if page<=1 %}disabled{% endif %}">
              <a class="page-link" href="{{ url_for('alumni', q=q, year=year, branch=branch, n=per_page, page=page-1) }}">Prev</a>
            </li>
            {% for p in range(1, pages+1) %}
            <li class="page-item {% if p==page %}active{% endif %}">
              <a class="page-link" href="{{ url_for('alumni', q=q, year=year, branch=branch, n=per_page, page=p) }}">{{ p }}</a>
            </li>
            {% endfor %}
            <li class="page-item {% if page>=pages %}disabled{% endif %}">
              <a class="page-link" href="{{ url_for('alumni', q=q, year=year, branch=branch, n=per_page, page=page+1) }}">Next</a>
            </li>
          </ul>
          <div class="text-center text-secondary small">Total: {{ total }}</div>
        </nav>
        {% else %}
        <div class="text-muted">No results.</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
