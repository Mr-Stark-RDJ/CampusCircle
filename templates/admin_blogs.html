{% extends "base.html" %}
{% block content %}
<ul class="nav nav-pills mb-3">
  <li class="nav-item"><a class="nav-link" href="/admin/events">Events</a></li>
  <li class="nav-item"><a class="nav-link active" href="/admin/blogs">Blogs</a></li>
  <li class="nav-item"><a class="nav-link" href="/admin/alumni">Alumni</a></li>
</ul>

<div class="d-flex justify-content-between align-items-center mb-3">
  <h4 class="mb-0">Blogs</h4>
  <a class="btn btn-primary" href="{{ url_for('admin_blogs_new') }}">Create Blog</a>
</div>

<div class="card shadow-sm mb-3">
  <div class="card-body">
    <form class="d-flex gap-2 flex-wrap" method="get">
      <input class="form-control" name="q" value="{{ q }}" placeholder="Search title or body">
      <select class="form-select" name="n" style="max-width:140px">
        <option value="20" {% if per_page==20 %}selected{% endif %}>Show 20</option>
        <option value="50" {% if per_page==50 %}selected{% endif %}>Show 50</option>
        <option value="100" {% if per_page==100 %}selected{% endif %}>Show 100</option>
      </select>
      <button class="btn btn-primary">Search</button>
    </form>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-dark table-striped align-middle">
        <thead><tr><th>Title</th><th>Status</th><th>Created</th><th class="text-end">Actions</th></tr></thead>
        <tbody>
        {% for b in blogs %}
          <tr>
            <td><a class="link-light" href="{{ url_for('blog_detail', slug=b.slug) }}">{{ b.title }}</a></td>
            <td>{% if b.published %}<span class="badge bg-success">Published</span>{% else %}<span class="badge bg-secondary">Draft</span>{% endif %}</td>
            <td>{{ b.created_at.strftime('%d %b %Y %H:%M') if b.created_at }}</td>
            <td class="text-end">
              <form method="post" action="{{ url_for('admin_blog_toggle', id=b.id) }}" class="d-inline"><button class="btn btn-sm btn-outline-info">Toggle</button></form>
              <form method="post" action="{{ url_for('admin_blog_delete', id=b.id) }}" class="d-inline ms-1"><button class="btn btn-sm btn-outline-danger">Delete</button></form>
            </td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

    <nav class="mt-3">
      <ul class="pagination justify-content-center">
        <li class="page-item {% if page<=1 %}disabled{% endif %}">
          <a class="page-link" href="{{ url_for('admin_blogs', q=q, n=per_page, page=page-1) }}">Prev</a>
        </li>
        {% for p in range(1, pages+1) %}
        <li class="page-item {% if p==page %}active{% endif %}">
          <a class="page-link" href="{{ url_for('admin_blogs', q=q, n=per_page, page=p) }}">{{ p }}</a>
        </li>
        {% endfor %}
        <li class="page-item {% if page>=pages %}disabled{% endif %}">
          <a class="page-link" href="{{ url_for('admin_blogs', q=q, n=per_page, page=page+1) }}">Next</a>
        </li>
      </ul>
      <div class="text-center text-secondary small">Total: {{ total }}</div>
    </nav>
  </div>
</div>
{% endblock %}
